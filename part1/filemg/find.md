# 搜索/重定向/管道

| 命令 | 说明 |
|:-|:-|
| [`find [path] [-options] [expression]`](#11-搜索文件)|在目录中搜索文件|
| [`grep [-opinions] [pattern] [file]`](#12-查找文件内容)|在文本文件中查找内容|
| `echo [-option] [string]`|在终端中打印字符串。通常会和重定向联合使用|
| [重定向和管道](#2-重定向和管道)|重定向:将终端输出保存至文件;管道:对终端输出进行再操作|

## 1. 搜索查找
### 1.1 搜索文件
```sh
# 命令格式
$ find [path] [-options] [expression]
```

* `find`命令功能非常强大，通常用来在特定目录下搜索符合条件的文件
* 文件查找路径缺省则在当前文件件搜索，**包含子目录**

```sh
# 在桌面及其子目录搜索所有txt文档
$ find ~/Desktop -name "*.txt"

# 在当前目录及子目录搜索文件名包含“app”的文件
$ find -name "*app*"
```

### 1.2 查找文件内容
```sh
# 命令格式
$ grep [-opinions] [pattern] [file]
```
* `grep`命令是一个强大的文本搜索工具
* `grep`允许对文本进行模式查找

#### 1) options

|options|含义|
|:-|:-|
|`-n`|显示行号|
|`-v`|搜索不匹配内容(相当于搜索结果取反)|
|`-i`|忽略字母大小写|

#### 2) pattern
常用的两种搜索模式,正则匹配

|参数|含义|
|:-|:-|
|`^b`|行首，搜索以b开头的行|
|`e$`|行尾, 搜索以e结尾的行|

```sh
# 在test.txt中搜索包含colin的行
$ grep colin test.txt

# 在test.txt中忽略大小写搜素以colin开头的行并显示行号
$ grep -ni ^colin test.txt
```
## 2. 重定向和管道
重定向和管道都需要配合其他命令使用。
### 2.1 重定向
重定向命令可以将终端输出内容保存到文件中
* `>` 将终端输出保存到文件中。文件不存在则创建，存在则覆盖
* `>>` 将终端输出追加到文件末尾。文件不存在则创建，存在则追加

```sh
# 将“Hello”保存到 a.txt 中
$ echo Hello > a.txt

# 将当前目录树状结构 追加到 a.txt 中
$ tree -d >> a.txt
```

`echo`和重定向命令经常一起使用以将输出的文本保存到文件中。

如果`echo`输出内容较为复杂如包含多个空格或换行，务必使用引号包裹以避免被解析为多个命令参数。**如果`echo`输出内容换行中包含`\`等特殊字符，必须使用单引号包裹才能保留换行，这在docker命令中常见。**

```sh
# 错误用法。双引号内容中有'\',换行将被忽略
$ echo "docker run \
-d \
--name my-mysql \
-e MYSQL_ROOT_PASSWORD=pwd \
mysql"

# 正确用法。使用单引号，换行将被保留
$ echo 'docker run \
-d \
--name my-mysql \
-e MYSQL_ROOT_PASSWORD=pwd \
mysql'
```

### 2.2 管道
管道是将一个命令的输出作为另一个命令的输入。可以理解为现实生活中一根管子，管子一头塞东西进去，另一头取东西出来。

常用管道命令有：
* `more`:分屏显示输出内容
* `grep`:对输出内容进行查询

```sh
# 分屏显示 当前目录所有内容
$ ls -lha | more

# 在前目录所有内容中 搜索名称包含colin的文件或目录
$ ls -lha | grep colin
```