# vi/vim编辑器

vi编辑器是linux下流行的文本编辑器。它可以执行输出、删除、查找、替换、块操作等众多文本操作，而且用户可以根据自己的需要对其进行定制。vim则是基于vi的高级编辑器。所有vim兼容vi所有的命令。Ubuntu部分版本的vi编辑器不太好用，推荐使用vim替代。

## 1. 工作模式
vi编辑器有以下三种工作模式。
### 1.1 命令模式
```sh
# 查看文件,如果文件不存在则新建文件
$ vi [文件名]     # 打开vi命令行编辑器并进入查看模式
```
进入vi编辑器之后，默认进入命令模式。任何模式，按一下ESC键，即可进入命令模式。此时从键盘上输入的任何字符都被当做编辑命令来解释，若输入的字符是合法的Vi命令，则Vi在接受用户命令之后完成相应的动作。但需注意的是，所输入的命令并不在屏幕上显示出来。若输入的字符不是Vi的合法命令，Vi会响铃报警。

### 1.2 编辑模式
在命令模式下输入插入命令i、附加命令a 、打开命令o、修改命令c、取代命令r或替换命令s都可以进入文本输入模式。在该模式下，用户输入的任何字符都被Vi当做文件内容保存起来，并将其显示在屏幕上。

命令|功能
:-|:-
i|插入光标前一个字符 
I|插入行首 
a|插入光标后一个字符 
A|插入行未 
o|向下新开一行,插入行首 
O|向上新开一行,插入行首

### 1.3 末行模式
```sh
# 所有命令必须进入命令模式后才能执行，命令执行完毕自动进入查看模式
:               # 进入末行模式,可以执行以下命令
wq              # 保存并退出
q!              # 不保存退出
set nu          # 显示行号
set nonu        # 取消行号
%d              # 清空文件内容
输入任意数字      # 光标定位到指定行号的行首位置
```

在命令模式下，用户按“:”键即可进入末行模式下，此时Vi会在显示窗口的最后一行(通常也是屏幕的最后一行)显示一个“:”作为末行模式的提示符，等待用户输入命令。多数文件管理命令都是在此模式下执行的(如把编辑缓冲区的内容写到文件中等)。末行命令执行完后，Vi自动回到命令模式。

## 2. 常用操作
### 2.1 命令模式
#### 1) 移动光标
命令|功能
:-|:-
k|上移 
j|下移 
h|左移 
l|右移
M|光标移动到中间行
L|光标移动到屏幕最后一行行首
G|移动到指定行,行号 -G
w|向后一次移动一个字 
b|向前一次移动一个字
{| 按段移动,上移 
}|按段移动,下移
Ctr-d|向下翻半屏 
Ctr-u|向上翻半屏
Ctr-f|向下翻一屏 
Ctr-b| 向上翻一屏
gg|光标移动文件开头 

光标移动在默认的vi中只能使用`kjhl`来控制，vim则增加了上下左右键的支持支持。

#### 2) 删除
命令|功能
:-|:-
**x**|删除光标后一个字符,相当于 Del 
**X**|删除光标前一个字符,相当于 Backspace
**dd**|删除光标所在行,n dd 删除指定的行数 D: 删除光标后本行所有内容,包含光标所在字符 
d0|删除光标前本行所有内容,不包含光标所在字符
dw|删除光标开始位置的字,包含光标所在字符

#### 3) 撤销
u|一步一步撤销 
Ctr-r|反撤销

#### 4) 重复
命令|功能
:-|:-
.|重复上一次操作的命令

#### 5) 文本行移动
命令|功能
:-|:-
>>|文本行右移 
<<|文本行左移

#### 6) 复制粘贴
命令|功能
:-|:-
y|复制选中
yy|复制当前行,n yy 复制 n 行 
p|在光标所在位置向下新开辟一行,粘贴

#### 7) 可视模式
命令|功能
:-|:-
v|按字符选中文本 
V|按行选中,选中文本可视模式可以配合 d, y, >>, << 实现对文本块的删除,复制,左右移动

#### 8) 查找操作
命令|功能
:-|:-
/或?|str查找
n|下一个
N|上一个

### 2.2 末行模式
```sh
# 末行模式下，将光标所在行的abc替换成123
%s/abc/123/g

# 末行模式下，将第一行至第10行之间的abc替换成123
1, 10s/abc/123/g
```